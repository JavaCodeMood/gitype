<div class="ui grid center aligned middle aligned">
    <div class="ui segment" style="width:23em;margin-top:10em;padding 2em 3em">
        <h1 class="ui horizontal divider header">登录</h1>
        <br />

        <form class="ui form">
            <div class="field" style="margin-bottom:2em">
                <input name="password" type="password" placeholder="请输入密码" />
                <div class="ui basic red pointing prompt label transition hidden" id="prompt">密码错误，请重新输入！</div>
            </div>

            <button type="submit" class="ui fluid blue button">登录</button>
        </form>

        <p style="margin-top:2em">
            Powered by
            <a href="https://github.com/caixw/typing">typing</a>
        </p>
    </div>
</div>

<script>
function pageInit(){
    app.setTitle('登录');

    $('form').on('submit', function(){
        $('form').addClass('loading');

        app.post({
            'url': app.adminAPI('/login'),
            'data': app.buildJSON($('form'))
        }).done(function(data, textStatus, jqXHR){
            window.sessionStorage.token = data.token;
            app.redirect('/dashboard');
        }).fail(function(jqXHR, textStatus, errorThrown){
            $('#prompt').removeClass('hidden').addClass('visible');
        }).always(function(){
            $('form').removeClass('loading');
        });

        return false; // 记得在submit最后返回，取消submit操作。
    }); // end form.submit
} // end pageInit
</script>
